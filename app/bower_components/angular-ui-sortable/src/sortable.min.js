angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,t,n){return{require:"?ngModel",link:function(r,i,s,o){function a(e,t){if(t&&typeof t==="function"){return function(n,r){e(n,r);t(n,r)}}return e}var u;var f={};var l={receive:null,remove:null,start:null,stop:null,update:null};angular.extend(f,e);if(o){r.$watch(s.ngModel+".length",function(){t(function(){i.sortable("refresh")})});l.start=function(e,t){t.item.sortable={index:t.item.index(),cancel:function(){t.item.sortable._isCanceled=true},isCanceled:function(){return t.item.sortable._isCanceled},_isCanceled:false}};l.activate=function(e,t){u=i.contents();var n=i.sortable("option","placeholder");if(n&&n.element&&typeof n.element==="function"){var r=i.find('[class="'+n.element().attr("class")+'"]');u=u.not(r)}};l.update=function(e,t){if(!t.item.sortable.received){t.item.sortable.dropindex=t.item.index();i.sortable("cancel")}u.detach().appendTo(i);if(t.item.sortable.received&&!t.item.sortable.isCanceled()){r.$apply(function(){o.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)})}};l.stop=function(e,t){if(!t.item.sortable.received&&"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()){r.$apply(function(){o.$modelValue.splice(t.item.sortable.dropindex,0,o.$modelValue.splice(t.item.sortable.index,1)[0])})}};l.receive=function(e,t){t.item.sortable.received=true};l.remove=function(e,t){if(!t.item.sortable.isCanceled()){r.$apply(function(){t.item.sortable.moved=o.$modelValue.splice(t.item.sortable.index,1)[0]})}};r.$watch(s.uiSortable,function(e,t){angular.forEach(e,function(e,t){if(l[t]){if(t==="stop"){e=a(e,function(){r.$apply()})}e=a(l[t],e)}i.sortable("option",t,e)})},true);angular.forEach(l,function(e,t){f[t]=a(e,f[t])})}else{n.info("ui.sortable: ngModel not provided!",i)}i.sortable(f)}}}])